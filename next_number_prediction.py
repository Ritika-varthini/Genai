# -*- coding: utf-8 -*-
"""app

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1l_YHn5yCUm_KDhJbEroxdsVxCwIQhJF-
"""

# Install Gradio (only if not already installed)
!pip install gradio --quiet

# Import required libraries
import numpy as np
import gradio as gr
from tensorflow.keras.models import load_model

# Load the trained model
model = load_model("rnn_model.keras")

# Define prediction function
def predict_next_number(n1, n2, n3):
    try:
        # Convert input to model format
        input_seq = np.array([[n1, n2, n3]]).reshape((1, 3, 1))
        prediction = model.predict(input_seq, verbose=0)
        return f"Predicted next number: {prediction[0][0]:.2f}"
    except Exception as e:
        return f"Error: {str(e)}"

# Define the Gradio UI
interface = gr.Interface(
    fn=predict_next_number,
    inputs=[
        gr.Number(label="Enter Number 1"),
        gr.Number(label="Enter Number 2"),
        gr.Number(label="Enter Number 3")
    ],
    outputs="text",
    title="RNN - Next Number Predictor",
    description="Enter 3 numbers and get the predicted next number using a trained RNN model.",
    theme="default"
)

# Launch the app
interface.launch()

